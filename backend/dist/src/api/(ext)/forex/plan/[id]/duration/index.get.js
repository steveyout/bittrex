"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const db_1=require("@b/db"),error_1=require("@b/utils/error"),query_1=require("@b/utils/query");exports.metadata={summary:"Get durations for a specific Forex plan",description:"Retrieves all available durations for a specific forex investment plan",operationId:"getForexPlanDurations",tags:["Forex","Plan","Duration"],requiresAuth:!0,logModule:"FOREX",logTitle:"Get Plan Durations",parameters:[{index:0,name:"id",in:"path",required:!0,description:"ID of the forex plan",schema:{type:"string"}}],responses:{200:{description:"Plan durations retrieved successfully",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string"},duration:{type:"number"},timeframe:{type:"string"}}}}}}},401:query_1.unauthorizedResponse,404:(0,query_1.notFoundMetadataResponse)("Forex Plan"),500:query_1.serverErrorResponse}};exports.default=async e=>{const{user:r,params:t,ctx:o}=e;if(!(null==r?void 0:r.id))throw(0,error_1.createError)({statusCode:401,message:"Unauthorized"});const{id:s}=t;try{if(!await db_1.models.forexPlan.findOne({where:{id:s,status:!0}}))throw(0,error_1.createError)({statusCode:404,message:"Forex Plan not found"});const e=await db_1.models.forexDuration.findAll({include:[{model:db_1.models.forexPlan,as:"plans",where:{id:s},through:{attributes:[]},required:!0}],attributes:["id","duration","timeframe"],order:[["timeframe","ASC"],["duration","ASC"]]});null==o||o.success("Request completed successfully");return e}catch(e){if(e.statusCode)throw e;console.error("Error fetching plan durations:",e);throw(0,error_1.createError)({statusCode:500,message:"Internal Server Error"})}};