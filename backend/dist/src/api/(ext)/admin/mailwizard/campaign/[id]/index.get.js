"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const query_1=require("@b/utils/query"),errors_1=require("@b/utils/schema/errors"),utils_1=require("../utils"),db_1=require("@b/db"),demoMask_1=require("@b/utils/demoMask");exports.metadata={summary:"Get a Mailwizard campaign",operationId:"getMailwizardCampaignById",tags:["Admin","Mailwizard","Campaigns"],description:"Retrieves detailed information about a specific Mailwizard campaign including its configuration, status, targets, and associated template details.",parameters:[{index:0,name:"id",in:"path",required:!0,description:"ID of the Mailwizard Campaign to retrieve",schema:{type:"string"}}],responses:{200:(0,errors_1.singleItemResponse)({type:"object",properties:{...utils_1.baseMailwizardCampaignSchema,template:{type:"object",properties:{id:{type:"string",description:"Template ID"},name:{type:"string",description:"Template name"}}}}},"Mailwizard campaign retrieved successfully"),401:errors_1.unauthorizedResponse,404:(0,errors_1.notFoundResponse)("Mailwizard Campaign"),500:errors_1.serverErrorResponse},permission:"view.mailwizard.campaign",requiresAuth:!0,logModule:"ADMIN_MAIL",logTitle:"Get Mail Campaign"};exports.default=async e=>{const{params:a,ctx:i}=e;null==i||i.step("Fetch mail campaign by ID");const r=await(0,query_1.getRecord)("mailwizardCampaign",a.id,[{model:db_1.models.mailwizardTemplate,as:"template",attributes:["id","name"]}]);if(r&&r.targets)try{const e=JSON.parse(r.targets),a=(0,demoMask_1.applyDemoMask)(e,["email"]);r.targets=JSON.stringify(a)}catch(e){console.error("Failed to parse targets for email masking:",e)}null==i||i.success("Get Mail Campaign retrieved successfully");return r};