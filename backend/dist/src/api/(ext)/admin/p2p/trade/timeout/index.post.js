"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const cron_1=require("@b/api/(ext)/p2p/utils/cron"),error_1=require("@b/utils/error");exports.metadata={summary:"Manually Trigger P2P Trade Timeout",description:"Manually triggers the P2P trade timeout process to expire trades that have passed their expiration time. Admin-only endpoint.",operationId:"triggerP2PTradeTimeout",tags:["Admin","P2P","Trades","Cron"],requiresAuth:!0,logModule:"ADMIN_P2P",logTitle:"Trigger trade timeout",responses:{200:{description:"Trade timeout process completed successfully"},401:{description:"Unauthorized - Admin access required"},500:{description:"Internal Server Error"}},permission:"edit.p2p.trade"};exports.default=async e=>{const{user:r,ctx:t}=e;if(!(null==r?void 0:r.id))throw(0,error_1.createError)({statusCode:401,message:"Unauthorized: Admin access required"});try{null==t||t.step("Executing trade timeout process");await(0,cron_1.p2pTradeTimeout)();null==t||t.success("Trade timeout process completed successfully");return{message:"P2P trade timeout process completed successfully",executedBy:r.id,executedAt:(new Date).toISOString()}}catch(e){null==t||t.fail("Failed to execute trade timeout process");throw(0,error_1.createError)({statusCode:500,message:e.message||"Failed to execute P2P trade timeout process"})}};