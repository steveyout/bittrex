"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const db_1=require("@b/db"),query_1=require("@b/utils/query"),errors_1=require("@b/utils/schema/errors"),error_1=require("@b/utils/error");exports.metadata={summary:"Updates an ecosystem token status",description:"Updates the status (active/inactive) of a specific ecosystem token. Validates that the associated blockchain is active before allowing the token to be enabled.",operationId:"updateEcosystemTokenStatus",tags:["Admin","Ecosystem","Token"],logModule:"ADMIN_ECO",logTitle:"Update token status",parameters:[{index:0,name:"id",in:"path",required:!0,description:"ID of the token to update",schema:{type:"string"}}],requestBody:{required:!0,content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"New status to apply (true for active, false for inactive)"}},required:["status"]}}}},responses:{200:{description:"Ecosystem token status updated successfully",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",description:"Success message"}}}}}},400:errors_1.badRequestResponse,401:query_1.unauthorizedResponse,404:(0,errors_1.notFoundResponse)("Ecosystem Token"),500:query_1.serverErrorResponse},requiresAuth:!0,permission:"edit.ecosystem.token"};exports.default=async e=>{const{body:t,params:s,ctx:o}=e,{id:r}=s,{status:a}=t;null==o||o.step("Validating token exists");const n=await db_1.models.ecosystemToken.findByPk(r);if(!n)throw(0,error_1.createError)({statusCode:404,message:`Token with ID ${r} not found`});null==o||o.step("Checking blockchain status");const i=await db_1.models.ecosystemBlockchain.findOne({where:{chain:n.chain}});if(i&&!i.status)throw"0.0.1"===i.version?(0,error_1.createError)({statusCode:400,message:`Please install the latest version of the blockchain ${n.chain} to enable this token`}):(0,error_1.createError)({statusCode:400,message:`${n.chain} Blockchain is disabled`});null==o||o.step(`Updating token status to ${a}`);const c=await(0,query_1.updateStatus)("ecosystemToken",r,a);null==o||o.success("Token status updated successfully");return c};