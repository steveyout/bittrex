"use strict";async function checkLicenseFileExists(e){if(!e)return!1;const s=process.cwd(),t=s.endsWith("backend")||s.endsWith("backend/")||s.endsWith("backend\\")?path_1.default.dirname(s):s,a=path_1.default.join(t,"lic",`${e}.lic`);try{await fs_1.promises.access(a);return!0}catch(e){return!1}}var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const db_1=require("@b/db"),errors_1=require("@b/utils/schema/errors"),fs_1=require("fs"),path_1=__importDefault(require("path")),error_1=require("@b/utils/error");exports.metadata={summary:"Update ecosystem blockchain status",description:"Updates the active status of an ecosystem blockchain. This allows administrators to enable or disable specific blockchain integrations within the ecosystem.",operationId:"updateEcosystemBlockchainStatus",tags:["Admin","Ecosystem","Blockchain"],parameters:[{index:0,name:"id",in:"path",required:!0,description:"Product ID of the blockchain to update",schema:{type:"string"}}],requestBody:{required:!0,content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"New status to apply to the blockchain (true for active, false for inactive)"}},required:["status"]}}}},responses:{200:(0,errors_1.successMessageResponse)("Blockchain status updated successfully"),400:errors_1.badRequestResponse,401:errors_1.unauthorizedResponse,404:(0,errors_1.notFoundResponse)("Blockchain"),500:errors_1.serverErrorResponse},requiresAuth:!0,permission:"edit.ecosystem.blockchain",logModule:"ADMIN_ECO",logTitle:"Update blockchain status"};exports.default=async e=>{const{body:s,params:t,ctx:a}=e,{id:r}=t,{status:o}=s;if(!0===o){null==a||a.step("Checking blockchain license");if(!await checkLicenseFileExists(r))throw(0,error_1.createError)({statusCode:403,message:"Cannot enable blockchain: License not activated. Please activate your license first."})}null==a||a.step(`Updating blockchain status to ${o}`);await db_1.models.ecosystemBlockchain.update({status:o},{where:{productId:r}});null==a||a.success("Blockchain status updated successfully");return{message:"Blockchain status updated successfully"}};