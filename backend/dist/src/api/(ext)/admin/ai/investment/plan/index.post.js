"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const query_1=require("@b/utils/query"),utils_1=require("./utils");exports.metadata={summary:"Creates a new AI Investment Plan",operationId:"createAiInvestmentPlan",tags:["Admin","AI Investment","Plan"],description:"Creates a new AI Investment Plan with specified parameters including profit ranges, investment amounts, and associated durations. The plan can be set as trending and configured with default results.",requestBody:{required:!0,content:{"application/json":{schema:utils_1.aiInvestmentPlanUpdateSchema}}},responses:(0,query_1.storeRecordResponses)(utils_1.aiInvestmentPlanStoreSchema,"AI Investment Plan"),requiresAuth:!0,permission:"create.ai.investment.plan",logModule:"ADMIN_AI",logTitle:"Create investment plan"};exports.default=async e=>{const{body:t,ctx:n}=e,{name:a,title:s,description:i,image:r,minProfit:o,maxProfit:l,minAmount:u,maxAmount:d,invested:m,profitPercentage:c,status:p,defaultProfit:f,defaultResult:I,trending:v,durations:P}=t;null==n||n.step("Validating plan data");const g=P?[{model:"aiInvestmentPlanDuration",method:"addDurations",data:P.map(e=>"string"==typeof e?e:e.value),fields:{source:"planId",target:"durationId"}}]:[];null==n||n.step("Creating plan record");const A=await(0,query_1.storeRecord)({model:"aiInvestmentPlan",data:{name:a,title:s,description:i,image:r,minProfit:o,maxProfit:l,minAmount:u,maxAmount:d,invested:m,profitPercentage:c,status:p,defaultProfit:f,defaultResult:I,trending:v},relations:g});null==n||n.success("Investment plan created successfully");return A};