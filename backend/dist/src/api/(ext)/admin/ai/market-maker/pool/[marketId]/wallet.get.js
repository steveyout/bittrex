"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const db_1=require("@b/db"),errors_1=require("@b/utils/schema/errors"),error_1=require("@b/utils/error"),wallet_1=require("@b/api/(ext)/ecosystem/utils/wallet");exports.metadata={summary:"Get admin wallet balances for Market Maker pool",operationId:"getMarketMakerPoolWallet",tags:["Admin","AI Market Maker","Pool"],description:"Retrieves the admin's wallet balances for both base and quote currencies associated with an AI Market Maker. This information is useful for checking available funds before making deposits to the pool.",parameters:[{index:0,name:"marketId",in:"path",required:!0,description:"ID of the AI Market Maker",schema:{type:"string"}}],responses:{200:{description:"Admin wallet balances retrieved successfully",content:{"application/json":{schema:{type:"object",properties:{base:{type:"object",description:"Base currency wallet information",properties:{currency:{type:"string",description:"Base currency symbol"},balance:{type:"number",description:"Available balance in base currency"},walletId:{type:"string",nullable:!0,description:"Wallet ID (null if wallet doesn't exist)"}}},quote:{type:"object",description:"Quote currency wallet information",properties:{currency:{type:"string",description:"Quote currency symbol"},balance:{type:"number",description:"Available balance in quote currency"},walletId:{type:"string",nullable:!0,description:"Wallet ID (null if wallet doesn't exist)"}}}}}}}},401:errors_1.unauthorizedResponse,404:(0,errors_1.notFoundResponse)("AI Market Maker"),500:errors_1.serverErrorResponse},requiresAuth:!0,logModule:"ADMIN_AI",logTitle:"Get Market Maker Pool Wallet",permission:"view.ai.market-maker.pool"};exports.default=async e=>{const{params:r,user:t,ctx:a}=e;if(!(null==t?void 0:t.id))throw(0,error_1.createError)(401,"Unauthorized");null==a||a.step("Get Market Maker Pool Wallet");const l=await db_1.models.aiMarketMaker.findByPk(r.marketId,{include:[{model:db_1.models.ecosystemMarket,as:"market"}]});if(!l)throw(0,error_1.createError)(404,"AI Market Maker not found");const o=l.market;if(!o)throw(0,error_1.createError)(404,"Ecosystem market not found");const s=o.currency,n=o.pair;let i=null,c=null;try{i=await(0,wallet_1.getWalletByUserIdAndCurrency)(t.id,s)}catch(e){}try{c=await(0,wallet_1.getWalletByUserIdAndCurrency)(t.id,n)}catch(e){}null==a||a.success("Get Market Maker Pool Wallet retrieved successfully");return{base:{currency:s,balance:i?Number(i.balance||0):0,walletId:(null==i?void 0:i.id)||null},quote:{currency:n,balance:c?Number(c.balance||0):0,walletId:(null==c?void 0:c.id)||null}}};