"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.DistributorBot=void 0;const BaseBot_1=require("../BaseBot");class DistributorBot extends BaseBot_1.BaseBot{constructor(t){super({...t,personality:"DISTRIBUTOR",tradeFrequency:"LOW"});this.sellBias=.9;this.maxDistributionPercent=2;this.resistanceBuildingStrength=1.5;this.totalDistributed=BigInt(0);this.distributionSessions=0}decideTrade(t){if(!this.canTrade())return{shouldTrade:!1,reason:"Cannot trade"};const e=Number(t.currentPrice)/1e18,r=Number(t.targetPrice)/1e18,i=(r-e)/e*100,s=e>r;if(i>this.maxDistributionPercent)return{shouldTrade:!1,reason:`Price too far below target (${i.toFixed(2)}%)`};if(!(Math.random()<this.sellBias))return this.totalDistributed>BigInt(0)&&Math.random()<.1?this.createBuyOrder(t,"Rebalancing small amount"):{shouldTrade:!1,reason:"Skipping - distributor prefers selling"};const o=e>=.95*t.priceRangeHigh,n=o?this.resistanceBuildingStrength:1,a=this.calculatePrice(t,"SELL"),u=this.calculateOrderSize(t),c=BigInt(Math.floor(Number(u)*n));this.distributionSessions++;return{shouldTrade:!0,side:"SELL",price:a,amount:c,purpose:s?"PRICE_PUSH":"LIQUIDITY",confidence:.7+(s?.2:0),reason:o?"Building resistance level":`Distributing (session ${this.distributionSessions})`}}createBuyOrder(t,e){const r=this.calculatePrice(t,"BUY"),i=this.calculateOrderSize(t);return{shouldTrade:!0,side:"BUY",price:r,amount:BigInt(Math.floor(.3*Number(i))),purpose:"LIQUIDITY",confidence:.4,reason:e}}calculateOrderSize(t){let e=1;Number(t.currentPrice)/1e18>1.02*(Number(t.targetPrice)/1e18)&&(e=1.3);const r=this.config.avgOrderSize*e,i=this.addVariance(r,.25);return BigInt(Math.floor(1e18*i))}calculatePrice(t,e){const r=Number(t.currentPrice)/1e18;if("SELL"===e){const t=r*(1+(.001+.002*Math.random()));return BigInt(Math.floor(1e18*t))}{const t=r*(1-.002*Math.random());return BigInt(Math.floor(1e18*t))}}recordTradeResult(t){super.recordTradeResult(t);t>0&&(this.totalDistributed+=BigInt(Math.floor(1e18*t)))}getCooldownTime(){return 12e4}getDistributionStats(){return{totalDistributed:(Number(this.totalDistributed)/1e18).toFixed(8),sessions:this.distributionSessions}}}exports.DistributorBot=DistributorBot;exports.default=DistributorBot;