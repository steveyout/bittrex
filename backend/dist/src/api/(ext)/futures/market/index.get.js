"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const db_1=require("@b/db"),query_1=require("@b/utils/query"),utils_1=require("./utils");exports.metadata={summary:"Retrieves all futures markets",description:"Fetches a list of all active futures markets.",operationId:"listFuturesMarkets",tags:["Futures","Markets"],logModule:"FUTURES",logTitle:"List futures markets",responses:{200:{description:"Futures markets retrieved successfully",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:utils_1.baseFuturesMarketSchema}}}}},401:query_1.unauthorizedResponse,404:(0,query_1.notFoundMetadataResponse)("Futures Market"),500:query_1.serverErrorResponse}};exports.default=async e=>{var t,s,r;const{ctx:u}=e;null===(t=null==u?void 0:u.step)||void 0===t||t.call(u,"Fetching active futures markets");const a=await db_1.models.futuresMarket.findAll({where:{status:!0}});null===(s=null==u?void 0:u.step)||void 0===s||s.call(u,"Formatting market data");const l=a.map(e=>({...e.toJSON(),symbol:`${e.currency}/${e.pair}`}));null===(r=null==u?void 0:u.success)||void 0===r||r.call(u,`Retrieved ${l.length} active futures markets`);return l};