"use strict";function getLatestOrdersForCandles(e){const t={};e.forEach(e=>{(!t[e.symbol]||t[e.symbol].updatedAt<e.updatedAt)&&(t[e.symbol]=e)});return Object.values(t)}function normalizeToIntervalBoundary(e,t){const s=new Date(e);switch(t){case"1w":const e=s.getUTCDay();s.setUTCDate(s.getUTCDate()-e);s.setUTCHours(0,0,0,0);break;case"3d":return 3*Math.floor(s.getTime()/2592e5)*24*60*60*1e3;case"1d":s.setUTCHours(0,0,0,0);break;case"12h":const t=12*Math.floor(s.getUTCHours()/12);s.setUTCHours(t,0,0,0);break;case"6h":const o=6*Math.floor(s.getUTCHours()/6);s.setUTCHours(o,0,0,0);break;case"4h":const r=4*Math.floor(s.getUTCHours()/4);s.setUTCHours(r,0,0,0);break;case"2h":const a=2*Math.floor(s.getUTCHours()/2);s.setUTCHours(a,0,0,0);break;case"1h":s.setUTCMinutes(0,0,0);break;case"30m":const n=30*Math.floor(s.getUTCMinutes()/30);s.setUTCMinutes(n,0,0);break;case"15m":const l=15*Math.floor(s.getUTCMinutes()/15);s.setUTCMinutes(l,0,0);break;case"5m":const u=5*Math.floor(s.getUTCMinutes()/5);s.setUTCMinutes(u,0,0);break;case"3m":const c=3*Math.floor(s.getUTCMinutes()/3);s.setUTCMinutes(c,0,0);break;case"1m":s.setUTCSeconds(0,0);break;default:s.setUTCMilliseconds(0)}return s.getTime()}function fillCandleGaps(e,t,s,o,r=500){const a=exports.intervalDurations[t]||6e4;if(0===e.length)return[];const n=new Map;for(const s of e){const e=normalizeToIntervalBoundary(s[0],t),o=n.get(e);if(o){o[2]=Math.max(o[2],s[2]);o[3]=Math.min(o[3],s[3]);o[4]=s[4];o[5]=o[5]+s[5]}else n.set(e,[e,s[1],s[2],s[3],s[4],s[5]])}const l=Array.from(n.values()).sort((e,t)=>e[0]-t[0]),u=[],c=normalizeToIntervalBoundary(o,t);for(let e=0;e<l.length;e++){const t=l[e];u.push(t);if(e<l.length-1){const s=l[e+1],o=t[0],n=s[0];if(n-o>1.5*a){const e=t[4];let s=o+a,l=0;for(;s<n&&l<r;){u.push([s,e,e,e,e,0]);s+=a;l++}}}}const i=l[l.length-1],h=i[0];if(h<c){let e=h+a,t=0;const s=i[4];for(;e<=c&&t<r;){u.push([e,s,s,s,s,0]);e+=a;t++}}return u}Object.defineProperty(exports,"__esModule",{value:!0});exports.intervalDurations=exports.intervals=void 0;exports.getLatestOrdersForCandles=getLatestOrdersForCandles;exports.normalizeToIntervalBoundary=normalizeToIntervalBoundary;exports.fillCandleGaps=fillCandleGaps;exports.intervals=["1m","3m","5m","15m","30m","1h","2h","4h","6h","12h","1d","3d","1w"];exports.intervalDurations={"1m":6e4,"3m":18e4,"5m":3e5,"15m":9e5,"30m":18e5,"1h":36e5,"2h":72e5,"4h":144e5,"6h":216e5,"12h":432e5,"1d":864e5,"3d":2592e5,"1w":6048e5};