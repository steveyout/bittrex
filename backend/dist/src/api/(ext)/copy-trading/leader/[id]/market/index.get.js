"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.metadata=void 0;const db_1=require("@b/db"),error_1=require("@b/utils/error");exports.metadata={summary:"Get leader's declared markets (public)",description:"Returns all active markets a leader has declared for trading. Used by followers to see which markets they can allocate to.",operationId:"getLeaderMarketsPublic",tags:["Copy Trading","Leader"],logModule:"COPY",logTitle:"Get leader markets public",parameters:[{name:"id",in:"path",required:!0,schema:{type:"string"},description:"Leader ID"}],responses:{200:{description:"Markets retrieved successfully",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string"},symbol:{type:"string"},baseCurrency:{type:"string"},quoteCurrency:{type:"string"},minBase:{type:"number",description:"Minimum base currency allocation"},minQuote:{type:"number",description:"Minimum quote currency allocation"}}}}}}},404:{description:"Leader not found"}}};exports.default=async e=>{const{params:r,ctx:t}=e;null==t||t.step("Validating leader exists");if(!await db_1.models.copyTradingLeader.findOne({where:{id:r.id,status:"ACTIVE",isPublic:!0}}))throw(0,error_1.createError)({statusCode:404,message:"Leader not found"});null==t||t.step("Fetching leader markets");const a=await db_1.models.copyTradingLeaderMarket.findAll({where:{leaderId:r.id,isActive:!0},attributes:["id","symbol","baseCurrency","quoteCurrency","minBase","minQuote"],order:[["createdAt","ASC"]]});null==t||t.success(`Retrieved ${a.length} markets`);return a};