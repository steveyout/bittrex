'use strict';const _0x2042f2=_0x219d;(function(_0x28901b,_0x498ca3){const _0x173d23=_0x219d,_0x3239bf=_0x28901b();while(!![]){try{const _0x37e252=parseInt(_0x173d23(0x204))/0x1+-parseInt(_0x173d23(0x205))/0x2*(parseInt(_0x173d23(0x1eb))/0x3)+parseInt(_0x173d23(0x1f7))/0x4*(-parseInt(_0x173d23(0x1fd))/0x5)+parseInt(_0x173d23(0x1fb))/0x6+parseInt(_0x173d23(0x1f5))/0x7*(parseInt(_0x173d23(0x1f1))/0x8)+parseInt(_0x173d23(0x206))/0x9*(-parseInt(_0x173d23(0x1f9))/0xa)+-parseInt(_0x173d23(0x1ed))/0xb*(-parseInt(_0x173d23(0x1ea))/0xc);if(_0x37e252===_0x498ca3)break;else _0x3239bf['push'](_0x3239bf['shift']());}catch(_0x43df8b){_0x3239bf['push'](_0x3239bf['shift']());}}}(_0xb2aa,0x9988f));function _0x219d(_0x1991ee,_0x1aed75){_0x1991ee=_0x1991ee-0x1d2;const _0xb2aa88=_0xb2aa();let _0x219d82=_0xb2aa88[_0x1991ee];return _0x219d82;}function getSwaggerDocPath(){const _0x5afd57=_0x219d,_0x4dcf6b=['production'===process['env'][_0x5afd57(0x1dc)]?path_1['default'][_0x5afd57(0x1ef)](process['cwd'](),'frontend','public',_0x5afd57(0x1d8)):path_1['default']['resolve'](process['cwd'](),'..','frontend','public',_0x5afd57(0x1d8))];for(const _0x164ff4 of _0x4dcf6b)if(fs_1['default'][_0x5afd57(0x1e1)](_0x164ff4))return _0x164ff4;return _0x4dcf6b[0x0];}function getApiSourcePath(){const _0x3d5c0c=_0x219d,_0x169f79=[..._0x3d5c0c(0x1f6)===process['env']['NODE_ENV']?[path_1['default']['resolve'](process['cwd'](),'backend','dist','src','api'),path_1['default']['resolve'](process['cwd'](),'dist','src','api')]:[],path_1['default']['resolve'](__dirname,_0x3d5c0c(0x1e9)),path_1[_0x3d5c0c(0x1d7)][_0x3d5c0c(0x1ef)](process[_0x3d5c0c(0x202)](),'backend','dist','src','api'),path_1[_0x3d5c0c(0x1d7)]['resolve'](process[_0x3d5c0c(0x202)](),'backend',_0x3d5c0c(0x1dd),'api'),path_1[_0x3d5c0c(0x1d7)]['resolve'](process['cwd'](),'src','api')];for(const _0x585b59 of _0x169f79)try{return fs_1['default']['accessSync'](_0x585b59),_0x585b59;}catch(_0x2bca8c){}return _0x169f79[0x0];}async function fileExists(_0x1e629e){try{return await fs_1['default']['promises']['access'](_0x1e629e),!0x0;}catch(_0x2031d6){return!0x1;}}async function generateSwaggerDocIfNeeded(){const _0x438f6a=_0x219d;if(!await fileExists(SWAGGER_DOC_PATH)||Date['now']()-lastSwaggerGenerationTime>0x493e0){const _0x5ae8e3=getApiSourcePath();await generateSwaggerDoc(_0x5ae8e3,_0x438f6a(0x1e2)),lastSwaggerGenerationTime=Date['now']();}}async function generateSwaggerDoc(_0x4f5aee,_0x419251='/api'){const _0x54cab1=_0x219d,_0x170f87=await fs_1['default'][_0x54cab1(0x207)][_0x54cab1(0x1f4)](_0x4f5aee,{'withFileTypes':!0x0});for(const _0x1e39ff of _0x170f87){const _0x4904c1=path_1[_0x54cab1(0x1d7)]['join'](_0x4f5aee,_0x1e39ff['name']);if(_0x1e39ff['isDirectory']()&&SKIP_DIRECTORIES['includes'](_0x1e39ff[_0x54cab1(0x1f2)]))continue;if(_0x1e39ff['name']['startsWith']('index.ws'))continue;const _0x1a3a2b=path_1['default']['extname'](_0x1e39ff[_0x54cab1(0x1f2)])[_0x54cab1(0x1f8)]();if(_0x1e39ff['isDirectory']()||VALID_FILE_EXTENSIONS['includes'](_0x1a3a2b)){if(_0x1e39ff['isDirectory']()){let _0x125eb0=_0x419251;/^\(.*\)$/['test'](_0x1e39ff[_0x54cab1(0x1f2)])||(_0x125eb0=_0x419251+'/'+_0x1e39ff['name'][_0x54cab1(0x1da)](/\[(\w+)\]/,':$1')),await generateSwaggerDoc(_0x4904c1,_0x125eb0);}else{const [_0x5f0f23,_0x372ecd]=_0x1e39ff[_0x54cab1(0x1f2)][_0x54cab1(0x1da)](/\.[jt]s$/,'')[_0x54cab1(0x1d5)]('.');if(!_0x372ecd)continue;if(!['get','post',_0x54cab1(0x1e4),_0x54cab1(0x1db),'delete','patch','options',_0x54cab1(0x1d6),'trace']['includes'](_0x372ecd['toLowerCase']()))continue;const _0x4e46dc=await loadRouteMetadata(_0x4904c1);let _0x395b0f=(_0x419251+'/'+_0x5f0f23)['replace'](/\/index$/,'');_0x395b0f=convertToSwaggerPath(_0x395b0f),swaggerDoc['paths'][_0x395b0f]||(swaggerDoc['paths'][_0x395b0f]={}),swaggerDoc['paths'][_0x395b0f][_0x372ecd[_0x54cab1(0x1f8)]()]={..._0x4e46dc,'responses':constructResponses(_0x4e46dc[_0x54cab1(0x200)]),'security':_0x4e46dc[_0x54cab1(0x203)]?[{'ApiKeyAuth':[]}]:[]};}}}const _0x2abb70=path_1[_0x54cab1(0x1d7)]['dirname'](SWAGGER_DOC_PATH);try{await fs_1[_0x54cab1(0x1d7)]['promises']['mkdir'](_0x2abb70,{'recursive':!0x0});}catch(_0x3732b4){}await(0x0,promises_1['writeFile'])(SWAGGER_DOC_PATH,JSON[_0x54cab1(0x1e7)](swaggerDoc,null,0x2),_0x54cab1(0x1fe));}async function loadRouteMetadata(_0x1854ac){const _0x50bd61=_0x219d;try{const _0x280517=await Promise[_0x50bd61(0x1ef)](''+_0x1854ac)['then'](_0x2ef993=>__importStar(require(_0x2ef993)));if(!_0x280517['metadata']||!_0x280517['metadata'][_0x50bd61(0x200)])return console_1['logger']['warn']('DOCS',_0x50bd61(0x1d4)+_0x1854ac),{'responses':{}};return _0x280517['metadata'];}catch(_0x5ca672){return _0x5ca672['message']&&_0x5ca672['message'][_0x50bd61(0x1e8)]('APP_VERIFY_TOKEN_SECRET')?console_1['logger']['warn'](_0x50bd61(0x1e0),'Skipping\x20'+_0x1854ac+_0x50bd61(0x1ee)):console_1['logger']['error'](_0x50bd61(0x1e0),'Error\x20loading\x20route\x20metadata\x20from\x20'+_0x1854ac+':\x20'+_0x5ca672['message']),{'responses':{}};}}function constructResponses(_0x5bf864){const _0x52457e=_0x219d;return Object['keys'](_0x5bf864)[_0x52457e(0x1e5)]((_0x2b0815,_0x539ddc)=>{const _0x1932ad=_0x52457e;return _0x2b0815[_0x539ddc]={'description':_0x5bf864[_0x539ddc][_0x1932ad(0x1ec)],'content':_0x5bf864[_0x539ddc][_0x1932ad(0x1e6)]},_0x2b0815;},{});}function convertToSwaggerPath(_0x47cf95){const _0x52db48=_0x219d;return _0x47cf95=(_0x47cf95=_0x47cf95[_0x52db48(0x1da)](/:([a-zA-Z0-9_]+)/g,'{$1}'))['replace'](/\[(\w+)]/g,_0x52db48(0x1f0));}function setupSwaggerRoute(_0x5df323){_0x5df323['get']('/api/docs/swagger.json',async _0x36a6d2=>{const _0x556de5=_0x219d;try{await generateSwaggerDocIfNeeded();const _0x458733=await fs_1[_0x556de5(0x1d7)]['promises'][_0x556de5(0x1fc)](SWAGGER_DOC_PATH,'utf8');_0x36a6d2['cork'](()=>{_0x36a6d2['writeHeader']('Content-Type','application/json')['end'](_0x458733);});}catch(_0xa7dbac){_0x36a6d2['cork'](()=>{const _0x1eaf19=_0x556de5;_0x36a6d2['writeStatus']('500\x20Internal\x20Server\x20Error')[_0x1eaf19(0x1fa)]('Internal\x20Server\x20Error');});}});}var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0xf12d21,_0x4403d3,_0x154235,_0x15eecd){const _0x42a546=_0x219d;void 0x0===_0x15eecd&&(_0x15eecd=_0x154235);var _0x1903fb=Object[_0x42a546(0x1ff)](_0x4403d3,_0x154235);_0x1903fb&&!('get'in _0x1903fb?!_0x4403d3['__esModule']:_0x1903fb['writable']||_0x1903fb['configurable'])||(_0x1903fb={'enumerable':!0x0,'get':function(){return _0x4403d3[_0x154235];}}),Object['defineProperty'](_0xf12d21,_0x15eecd,_0x1903fb);}:function(_0xf83598,_0x2c14e8,_0x104b4f,_0x4ba5f7){void 0x0===_0x4ba5f7&&(_0x4ba5f7=_0x104b4f),_0xf83598[_0x4ba5f7]=_0x2c14e8[_0x104b4f];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object['create']?function(_0x169630,_0x210fab){Object['defineProperty'](_0x169630,'default',{'enumerable':!0x0,'value':_0x210fab});}:function(_0x1a181d,_0x4a9ef9){_0x1a181d['default']=_0x4a9ef9;}),__importStar=this&&this[_0x2042f2(0x1e3)]||(function(){var _0x3fd5dc=function(_0x1addc9){const _0x67672a=_0x219d;return _0x3fd5dc=Object[_0x67672a(0x1d2)]||function(_0x8a0908){const _0x3e6a3c=_0x67672a;var _0x5c0a8e=[];for(var _0x38b619 in _0x8a0908)Object['prototype']['hasOwnProperty'][_0x3e6a3c(0x1d3)](_0x8a0908,_0x38b619)&&(_0x5c0a8e[_0x5c0a8e[_0x3e6a3c(0x1df)]]=_0x38b619);return _0x5c0a8e;},_0x3fd5dc(_0x1addc9);};return function(_0x433c5a){const _0x39178e=_0x219d;if(_0x433c5a&&_0x433c5a['__esModule'])return _0x433c5a;var _0x37a374={};if(null!=_0x433c5a){for(var _0x494466=_0x3fd5dc(_0x433c5a),_0x4513ef=0x0;_0x4513ef<_0x494466[_0x39178e(0x1df)];_0x4513ef++)'default'!==_0x494466[_0x4513ef]&&__createBinding(_0x37a374,_0x433c5a,_0x494466[_0x4513ef]);}return __setModuleDefault(_0x37a374,_0x433c5a),_0x37a374;};}()),__importDefault=this&&this[_0x2042f2(0x1d9)]||function(_0x234417){return _0x234417&&_0x234417['__esModule']?_0x234417:{'default':_0x234417};};Object['defineProperty'](exports,_0x2042f2(0x201),{'value':!0x0}),exports['setupSwaggerRoute']=setupSwaggerRoute;const fs_1=__importDefault(require('fs')),path_1=__importDefault(require('path')),promises_1=require('fs/promises'),console_1=require('@b/utils/console'),SWAGGER_DOC_PATH=getSwaggerDocPath(),REGENERATION_INTERVAL=0x493e0,swaggerDoc={'openapi':_0x2042f2(0x1de),'info':{'title':process['env']['SITE_NAME']||'API\x20Documentation','version':'1.0.0','description':process['env']['SITE_DESCRIPTION']||'This\x20is\x20the\x20API\x20documentation\x20for\x20the\x20site,\x20powered\x20by\x20Mash\x20Server.'},'paths':{},'components':{'schemas':{},'responses':{},'parameters':{},'requestBodies':{},'securitySchemes':{'ApiKeyAuth':{'type':_0x2042f2(0x1f3),'in':'header','name':'X-API-KEY'}}},'tags':[]};let lastSwaggerGenerationTime=0x0;const SKIP_DIRECTORIES=['cron','admin','util','integration','plugins','assets','includes'],VALID_FILE_EXTENSIONS=['.ts','.js'];function _0xb2aa(){const _0x27c435=['utf8','getOwnPropertyDescriptor','responses','__esModule','cwd','requiresAuth','205155nXlcHU','747240NKHdkc','9JXRcsw','promises','getOwnPropertyNames','call','No\x20proper\x20\x27metadata\x27\x20exported\x20from\x20','split','head','default','swagger.json','__importDefault','replace','del','NODE_ENV','src','3.0.0','length','DOCS','existsSync','/api','__importStar','put','reduce','content','stringify','includes','../api','336YAmgqZ','3mslBPl','description','672738GGFFFH','\x20-\x20Missing\x20environment\x20variable:\x20APP_VERIFY_TOKEN_SECRET','resolve','{$1}','5480JbuBen','name','apiKey','readdir','4844Lardle','production','497428doqhAy','toLowerCase','8123210tIuZFR','end','3254604XDibPI','readFile','45OxvXju'];_0xb2aa=function(){return _0x27c435;};return _0xb2aa();}